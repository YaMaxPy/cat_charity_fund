# Приложение для Благотворительного фонда поддержки котиков QRKot

## Описание
```
- Фонд собирает пожертвования на различные целевые проекты: на медицинское обслуживание нуждающихся хвостатых, на обустройство кошачьей колонии в подвале, на корм оставшимся без попечения кошкам — на любые цели, связанные с поддержкой кошачьей популяции.

- Проекты:
В Фонде QRKot может быть открыто несколько целевых проектов. У каждого проекта есть название, описание и сумма, которую планируется собрать. После того, как нужная сумма собрана — проект закрывается.
Пожертвования в проекты поступают по принципу First In, First Out: все пожертвования идут в проект, открытый раньше других; когда этот проект набирает необходимую сумму и закрывается — пожертвования начинают поступать в следующий проект.

- Пожертвования:
Каждый пользователь может сделать пожертвование и сопроводить его комментарием. Пожертвования не целевые: они вносятся в фонд, а не в конкретный проект. Каждое полученное пожертвование автоматически добавляется в первый открытый проект, который ещё не набрал нужную сумму. Если пожертвование больше нужной суммы или же в Фонде нет открытых проектов — оставшиеся деньги ждут открытия следующего проекта. При создании нового проекта все неинвестированные пожертвования автоматически вкладываются в новый проект.

- Пользователи:
Целевые проекты создаются администраторами сайта. 
Любой пользователь может видеть список всех проектов, включая требуемые и уже внесенные суммы. Это касается всех проектов — и открытых, и закрытых.
Зарегистрированные пользователи могут отправлять пожертвования и просматривать список своих пожертвований.

- Процесс «инвестирования»:
Сразу после создания нового проекта или пожертвования запускается процесс «инвестирования». 
Если создан новый проект, а в базе были «свободные» (не распределённые по проектам) суммы пожертвований — они автоматически инвестируются в новый проект. То же касается и создания пожертвований: если в момент пожертвования есть открытые проекты, эти пожертвования автоматически зачисляются на их счета.
```

### Запуск приложения:
1. Склонируйте репозиторий:

```
git clone git@github.com:YaMaxPy/cat_charity_fund.git
```

2. Перейдите в директорию с проектом:

```
cd cat_charity_fund
```

3. Создайте и активируйте вирутальное окружение:

```
python -m venv venv
```
```
Если у вас Linux/macOS: source venv/bin/activate
Если у вас Windows: source venv/Scripts/activate
```

4. Установите зависимости из файла requirements.txt:

```
python3 -m pip install --upgrade pip
```
```
pip install -r requirements.txt
```

5. Создайте в корневой директории файл .env со следующим наполнением:

```
APP_TITLE=Кошачий благотворительный фонд (0.1.0)
DESCRIPTION=Сервис для поддержки котиков!
DATABASE_URL=sqlite+aiosqlite:///./<название базы данных>.db
SECRET=<ваш_секретный_ключ>
FIRST_SUPERUSER_EMAIL=<e-mail суперюзера>
FIRST_SUPERUSER_PASSWORD=<пароль суперюзера>
```

6. Создать базу данных и выполнить миграции:

```
alembic upgrade head
```

### Управление:
Для локального запуска выполните команду:
```
uvicorn app.main:app --reload
```
Сервис будет запущен и доступен по следующим адресам:
- http://127.0.0.1:8000 - API
- http://127.0.0.1:8000/swagger - автоматически сгенерированная документация Swagger
- http://127.0.0.1:8000/redoc - автоматически сгенерированная документация ReDoc

### Работа с API:
После запуска доступны следующие эндпоинты:
- Регистрация и аутентификация:
    - **/auth/register** - регистрация пользователя
    - **/auth/jwt/login** - аутентификация пользователя (получение jwt-токена)
    - **/auth/jwt/logout** - выход (сброс jwt-токена)
- Пользователи:
    - **/users/me** - получение и изменение данных аутентифицированного пользователя
    - **/users/{id}** - получение и изменение данных пользователя по id
- Благотворительные проекты:
    - **/charity_project/** - получение списка проектов и создание нового
    - **/charity_project/{project_id}** - изменение и удаление существующего проекта
- Пожертвования:
    - **/donation/** - получение списка всех пожертвований и создание пожертвования
    - **/donation/my** - получение списка всех пожертвований аутентифицированного пользователя

Со схемами запросов и ответов можно ознакомиться в документации или в файле со спецификацией - openapi.json.

#### Ключевые технологии и библиотеки:
- [Python](https://www.python.org/);
- [FastAPI](https://pypi.org/project/fastapi/);
- [SQLAlchemy](https://pypi.org/project/SQLAlchemy/);
- [Alembic](https://pypi.org/project/alembic/);

#### Автор
- [Радченко Максим](https://github.com/YaMaxPy "GitHub аккаунт")